const mainContainer=document.getElementById("main-container"),jsonContainer=document.getElementById("json-container"),title=document.getElementById("title"),errorMessage=document.getElementById("error-message"),loader=document.getElementById("loader"),output=document.getElementById("output"),more=document.getElementById("more"),worker=new Worker("./worker.min.js");worker.addEventListener("message",({data:e})=>{handleMessage(e)});const handleMessage=e=>{let{isValid:t,json:n,fileName:r,keyName:a}=e;if(!t){errorMessage.style.display="block",errorMessage.textContent="Invalid file. Please load a valid JSON file.";return}if(mainContainer.style.display="none",jsonContainer.style.display="block",title.textContent=r,"root"===a){output.appendChild(createStructure(n));return}let l=output.querySelector(`[data-key-name="${a}"]`)?.parentElement;if(!l)return;l.innerHTML="";let o=createStructure(n),s=o.childElementCount;for(let d=0;d<s;d++)l.appendChild(o.children.item(0))};document.getElementById("file").addEventListener("change",async e=>{let t=e.target.files[0];t&&worker.postMessage({type:"load",file:t})});const observer=new IntersectionObserver(e=>{e[0].isIntersecting&&worker.postMessage({type:"more"})});function createStructure(e){let t=Object.keys(e),n=document.createElement("ul");for(let r of t){let a=document.createElement("li"),l=document.createElement("span");l.classList.add("key"),l.textContent=r+":",a.appendChild(l);let o=e[r];if("..."===r){a.appendChild(createLoadMoreButton(o)),n.appendChild(a);continue}let s=null===o;if(s||"object"!=typeof o){let d=document.createElement("span");d.classList.add("value"),s?d.textContent="null":"string"==typeof o?d.textContent=`"${o}"`:d.textContent=o,a.appendChild(d)}else Array.isArray(o)&&a.classList.add("array"),a.appendChild(createStructure(o));n.appendChild(a)}return n}observer.observe(more);const createLoadMoreButton=e=>{let t=document.createElement("button");return t.textContent=e,t.dataset.keyName=e,t.addEventListener("click",e=>{let t=e.target.dataset.keyName;worker.postMessage({type:"more",keyName:t})}),t};